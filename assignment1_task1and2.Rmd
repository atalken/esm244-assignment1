---
title: "esm244_assignment1_task1and2"
author: "Anna Talken"
date: "1/17/2021"
output: html_document
---

```{r setup, include=FALSE, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(readxl)
library(lubridate)
library(patchwork)
```

### Read in the data
```{r, warning=FALSE, message=FALSE}
#read in the data
amphibians <- read_excel(here("data", "sierra_amphibians.xlsx"))

amphibian_ls <- amphibians %>% 
  filter(amphibian_species == "RAMU") %>% #filter to include only mountain yellow-legged frog
  filter(amphibian_life_stage == c("SubAdult", "Tadpole", "Adult")) %>% 
  mutate(year_new = year(survey_date))  %>%  #created new column with only year
  count(year_new, amphibian_life_stage, sort = TRUE) #count number of frogs by year and life stage

```

### Graph #1: Comparing Mountain Yellow-Legged Frog populations by life stage
```{r}
#create ggplot
graph1 <- ggplot(data = amphibian_ls, aes(x = year_new, y = n, color = amphibian_life_stage)) +
  geom_point() +
  geom_line() +
  theme_minimal() +
  labs(title = "Mountain yellow-legged frog population from 1995 to 2002",
       x = "Year",
       y= "Number")
```

### Graph #2: Top 5 Lakes with Mountain Yellow-Legged Frogs

```{r}

amphibians$lake_id <-as.character(as.numeric(amphibians$lake_id))


amphibian_adults <- amphibians %>% 
  filter(amphibian_life_stage %in% c("SubAdult", "Adult")) %>% #filter to include only Adult and SubAdult frogs
  filter(amphibian_location == "in lake") %>% #only include frogs in the lake
  count(lake_id) %>% 
  arrange(desc(n)) %>% #arrange in descending order
  slice(1:5) #only keep top 5 values for n


graph2 <- ggplot(data= amphibian_adults, aes(x=reorder(lake_id, -n), y=n)) +
  geom_col(fill = "cyan4") +
  labs(title = "Top 5 lakes with the greatest number of mountain yellow-legged frogs", 
       x= "Lake ID",
       y = "Number") +
  theme_minimal() 

```
### Combine graphs using 'patchwork' package

```{r}
graph1 / graph2 #combining graph 1 and graph 2 on the same figure

```
























